!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(t){return e[t]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(){"use strict";function e(){let e,t=document.getElementById("api").value;try{e=new URL(t)}catch(e){o(function(e){let t=document.createElement("div"),n=new Date;return t.innerHTML=n.toISOString()+" "+e,t}(e))}return e}function t(t){let n="/api/agent/",o=e(),r=o.protocol+"//"+o.host+n+t.id;""!=o.username&&""!=o.password&&(r=o.protocol+"//"+o.username+":"+o.password+"@"+o.host+n+t.id);let i=document.createElement("div"),a=document.createElement("div"),d=document.createElement("div"),l=document.createElement("div"),c=document.createElement("div"),u=document.createElement("a"),s=document.createElement("a"),m=document.createElement("a"),p=document.createElement("span"),f=document.createElement("span"),h=document.createElement("span"),g=document.createElement("span"),w=document.createElement("div"),b=document.createElement("a"),v=document.createElement("a"),E=document.createElement("a");u.innerHTML=t.username+"@"+t.hostname+" ",s.innerHTML=" "+t.pwd,s.setAttribute("target","_blank"),s.setAttribute("href",r+"/rootfs"+t.pwd),m.innerHTML=" ~ ",m.setAttribute("target","_blank"),m.setAttribute("href",r+"/rootfs/home/"+t.username),p.appendChild(u),f.appendChild(s);for(let e of t.tags){let t=document.createElement("a");t.innerHTML=e,t.setAttribute("class","tag"),h.appendChild(t)}if(g.appendChild(m),E.innerHTML=t.ip,E.setAttribute("target","_blank"),E.setAttribute("href","https://www.wolframalpha.com/input/?i="+t.ip+" ip geolocation"),v.innerHTML=" | ",b.innerHTML="connect",b.setAttribute("target","_blank"),b.setAttribute("href",r+"/"),l.setAttribute("class","agent-topbar"),l.appendChild(p),l.appendChild(h),c.setAttribute("class","agent-midbar"),c.appendChild(f),c.appendChild(g),w.setAttribute("class","agent-subbar"),w.innerHTML="connected "+function(e){var t=Math.round;let n=t((Date.now()/1e3-e)/60);return 60>n?n.toString()+" min":60<=n&&1440>n?t(n/60).toString()+" hour":t(n/60/24).toString()+" day"}(t.connected)+" ago | "+t.name+" | "+t.git_summary+" | ",w.appendChild(E),w.appendChild(v),w.appendChild(b),a.setAttribute("class","agent-left"),a.className+=t.auth?" auth":" noauth",a.innerHTML="*",t.distro){let e=t.distro,n=e.slice(0,1).toUpperCase()+e.slice(1,2);a.innerHTML=n}return d.setAttribute("class","agent-right"),d.appendChild(l),d.appendChild(c),d.appendChild(w),i.setAttribute("class","agent"),i.setAttribute("id",t.id),i.appendChild(a),i.appendChild(d),i}function n(e){let n=document.getElementById("agents"),o=new Set,r=new Set;for(let e of n.childNodes)o.add(e.id);for(let t of e)r.add(t.id);for(let r of e)if(!o.has(r.id)){let e=t(r);n.insertBefore(e,n.firstChild),o.add(r.id)}for(let e of n.childNodes)r.has(e.id)||n.removeChild(e);s++}function o(e){let t=document.getElementById("stats");for(;3<=t.childNodes.length;)t.removeChild(t.lastChild);t.prepend(e)}function r(){let e="https:"==window.location.protocol||u?"wss://":"ws://",t=u?i:window.location.host;var a=new WebSocket(e+t+"/api/agents/watch");a.binaryType="blob",a.onopen=()=>{o(function(){let e=document.createElement("div"),t=new Date;return e.innerHTML=t.toISOString()+" Start Watching Agents",e}())},a.onclose=e=>{o(function(){let e=document.createElement("div"),t=new Date;return e.innerHTML=t.toISOString()+" WebSocket Connection Closed",e}()),setTimeout((function(){r()}),5)},a.addEventListener("message",(function(e){let t=e.data,r=JSON.parse(t);n(r),function(e){window.localStorage.setItem("agents",e)}(t),o(function(e){let t=document.createElement("div"),n=new Date;return t.innerHTML=n.toISOString()+" "+e.toString()+" Agents Connected",t}(r.length))}))}var i="hub.k0s.io",a="https://"+i,d=window.chrome&&window.chrome.runtime&&window.chrome.runtime.id,l="conntroll.github.io"==window.location.host,c="k0s.io"==window.location.host,u=d||l||c,s=0;window.onload=function(){(function(){let e=document.getElementById("api");u?e.value=a:e.value=window.location.origin})(),function(){var e=window.localStorage.getItem("agents");if(null!=e&&0!=e.length){n(JSON.parse(e))}}(),r(),function(){var e=document.getElementById("agents");new MutationObserver((function(e){e.forEach((function(e){var t=e.addedNodes,n=e.removedNodes;if("granted"==Notification.permission&&3<s){if(0!=t.length){var o=new Notification("added"+new Date);console.log(t,o)}if(0!=n.length){o=new Notification("removed"+new Date);console.log(n,o)}}}))})).observe(e,{attributes:!0,childList:!0,characterData:!0})}()}}]);
//# sourceMappingURL=bundle.js.map